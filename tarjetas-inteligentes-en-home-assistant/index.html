<!doctype html><html class=no-js lang=es><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Tarjetas inteligentes en Home Assistant - Sherblog</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content="Como crear y utilizar tarjetas inteligentes en Home assistant mediante auto-entities"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://www.sherblog.pro/images/20221015_home_assistant_auto_entities_00.jpg"><meta name=twitter:title content="Tarjetas inteligentes en Home Assistant"><meta name=twitter:description content="Como crear y utilizar tarjetas inteligentes en Home assistant mediante auto-entities"><meta name=twitter:creator content="@sherblogpro"><meta name=twitter:site content="sherblog.pro"><meta property="og:type" content="article"><meta property="og:locale" content="es_ES"><meta property="og:site_name" content="sherblog.pro"><meta property="og:locale" content="es_ES"><meta property="og:title" content="Tarjetas inteligentes en Home Assistant"><meta property="og:url" content="https://sherlockes.github.io"><meta property="og:description" content="Como crear y utilizar tarjetas inteligentes en Home assistant mediante auto-entities"><meta property="og:image" content="http://www.sherblog.pro/images/20221015_home_assistant_auto_entities_00.jpg"><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/custom.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><a rel=me href=https://emacs.ch/@Sherlockes>Mastodon</a><div class="container container--outer"><header class=header><meta name=twitter:card content="summary"><meta name=twitter:title content="Tarjetas inteligentes en Home Assistant"><meta name=twitter:description content="Como crear y utilizar tarjetas inteligentes en Home assistant mediante auto-entities"><div class=container><div class=logo><a class=logo__link href=/ title=Sherblog rel=home><div class=logo__title>Sherblog</div><div class=logo__tagline>Sólo mi forma de hacer las cosas...</div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menú</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/post/computing/emacs/><span class=menu__text>Emacs</span></a></li><li class=menu__item><a class=menu__link href=/post/computing/hugo/><span class=menu__text>Hugo</span></a></li><li class=menu__item><a class=menu__link href=/mis-v%C3%A9rtices-geod%C3%A9sicos/><span class=menu__text>Mis vértices geodésicos</span></a></li><li class=menu__item><a class=menu__link href=/post/computing/raspberry/><span class=menu__text>Raspberry Pi desde cero</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Tarjetas inteligentes en Home Assistant</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2022-10-16T00:00:00Z>2022-10-16</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/home-assistant/ rel=category>home assistant</a></span></div></div></header><figure class="post__thumbnail thumbnail"><img class=thumbnail__image src=/images/20221015_home_assistant_auto_entities_00.jpg alt="Tarjetas inteligentes en Home Assistant"></figure><div class="content post__content clearfix"><p>Para que el contenido de una tarjeta del panel de control de <a href=https://www.home-assistant.io>Home Assistant</a> sea dinámico y potenciar toda su funcionalidad, la forma más sencilla es mediante el uso de <a href=https://github.com/thomasloven/lovelace-auto-entities>auto-entities</a>. Aquí dejo la forma de realizarlo.</p><p>El objetivo de hoy es sencillo, conseguir que la tarjeta que me muestra el estado de la batería de todos los equipos que utilizo en la domótica de casa se muestre ordenada según la batería disponible de cada uno de los equipos. Para esto voy a hacer uso de <a href=https://github.com/thomasloven/lovelace-auto-entities>auto-entities</a>.</p><h3 id=instalación-de-auto-entities>Instalación de auto-entities</h3><p>Gracias a <a href=https://hacs.xyz>HACS</a> la instalación de <a href=https://github.com/thomasloven/lovelace-auto-entities>auto-entities</a> se realiza de forma muy sencilla. Accederemos al panel de control de HACS posteriormente el menú &ldquo;Interfaz&rdquo; y usaremos el botón de abajo &ldquo;Explorar y descargar repositorios&rdquo;</p><p><img src=/images/20221015_home_assistant_auto_entities_01.jpg alt=image-01></p><p>Buscaremos &ldquo;auto-entities&rdquo; en el cuadro de diálogo de la lupa e instalaremos la ultima versión disponible.</p><blockquote><p>Tras la instalación he tenido algún problema a la hora de incluir nuevas tarjetes, no tengo claro si hay que refrescar el navegador o acceder a <a href=https://my.home-assistant.io/redirect/lovelace_resources>Dashboard Resources</a> y actualizar el módudo de javascript correspondiente a &ldquo;auto entities&rdquo;.</p></blockquote><h3 id=tarjeta-de-baterías>Tarjeta de baterías</h3><p>Editamos el panel de control que deseemos y añadimos una nueva tarjeta mediante el botón "</p><p><img src=/images/20221015_home_assistant_auto_entities_02.jpg alt=image-02></p><p>Y este es el código que tengo incluido para añadir y ordenar todos los niveles de batería que tengo disponibles en <a href=https://www.home-assistant.io>Home Assistant</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>custom:auto-entities</span>
</span></span><span style=display:flex><span><span style=color:#f92672>show_empty</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span><span style=color:#f92672>card</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>entities</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>title</span>: <span style=color:#ae81ff>Estado de baterías</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>show_header_toggle</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span><span style=color:#f92672>filter</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>include</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>entity_id</span>: <span style=color:#e6db74>&#39;*battery_level*&#39;</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>entity_id</span>: <span style=color:#e6db74>&#39;*_power*&#39;</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>entity_id</span>: <span style=color:#e6db74>&#39;*_battery&#39;</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>entity_id</span>: <span style=color:#e6db74>&#39;*_bateria&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>exclude</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>entity_id</span>: <span style=color:#e6db74>&#39;*power_factor*&#39;</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>entity_id</span>: <span style=color:#e6db74>&#39;*power_status*&#39;</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>entity_id</span>: <span style=color:#e6db74>&#39;*_battery_power*&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>sort</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>method</span>: <span style=color:#ae81ff>state</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>reverse</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ignore_case</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>numeric</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><p>He utilizado los filtros &ldquo;include&rdquo; y &ldquo;exclude&rdquo; para añadir o quitar las distintas entidades disponibles según e nombre de la entidad. Además, también está ordenado en modo numérico según el estado de cada una. El resultado es el siguiente.</p><p><img src=/images/20221015_home_assistant_auto_entities_03.jpg alt=image-03></p><h3 id=tarjeta-de-luces-encendidas>Tarjeta de luces encendidas</h3><p>Otro uso interesante que he encontrado para <a href=https://github.com/thomasloven/lovelace-auto-entities>auto-entities</a> es la creación de una tarjeta de luces encendidas. En esta tarjeta se mostrarán sólo las luces que tenga encendidas en casa gracias a este simple código.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>custom:auto-entities</span>
</span></span><span style=display:flex><span><span style=color:#f92672>show_empty</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span><span style=color:#f92672>card</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>entities</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>title</span>: <span style=color:#ae81ff>Luces encendidas</span>
</span></span><span style=display:flex><span><span style=color:#f92672>filter</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {% for light in states.light %}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      {% if light.state == &#34;on&#34; %}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        {{ light.entity_id}},
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      {% endif %}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {% endfor %}</span>    
</span></span></code></pre></div><p>Con una simple plantilla se añaden a la tarjeta únicamente las luces (states.light) que están encendidas (light.state == &ldquo;on&rdquo;). Además gracias a la línea <code>show_empty: false</code> la tarjeta sólo se muestra cuando hay alguna luz encendida. Este el el aspecto de la tarjeta.</p><p><img src=/images/20221015_home_assistant_auto_entities_04.jpg alt=image-04></p><p>Seguramente esta herramienta sea útil en muchas ocasiones, intentaré adjuntarlas aquí.</p><h3 id=enlaces-de-interés>Enlaces de interés</h3><ul><li><a href=https://github.com/thomasloven/hass-config/wiki/Lovelace-Plugins>Thomas Loven - Lovelace plugins</a>
<a href=https://community.home-assistant.io/t/lovelace-auto-entities-not-working-in-93-2/123807/6>Community Home Assistant - Auto-entities not working</a></li></ul></div><footer class=post__footer><div class="content post__content clearfix"><h3>Otros de mís artículos que te pueden interesar</h3><ul><li><a href=/calcular-temperatura-media-en-home-assistant/>Calcular temperatura media en Home Assistant</a></li><li><a href=/realizar-acciones-mediante-plantillas-en-home-assistant/>Realizar acciones mediante plantillas en Home Assistant</a></li><li><a href=/sensores-virtuales-y-jinja2-en-home-assistant/>Sensores virtuales y Jinja2 en Home Assistant</a></li><li><a href=/configuraci%C3%B3n-de-home-assistant-en-github/>Configuración de Home Assistant en github</a></li><li><a href=/instalaci%C3%B3n-de-home-assistant-en-raspberry/>Instalación de Home Assistant en Raspberry</a></li></ul></div><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/hacs/ rel=tag>hacs</a></li></ul></div></footer></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/de-youtube-a-podcast/ rel=prev><span class=pager__subtitle>«&#8201;Anterior</span><p class=pager__title>De Youtube a Podcast</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=/crear-y-configurar-una-instancia-gratuita-en-oracle/ rel=next><span class=pager__subtitle>Siguiente&#8201;»</span><p class=pager__title>Crear y configurar una instancia gratuita en Oracle</p></a></div></nav><div class="content post__content clearfix"><h3>Comentarios</h3>Atrás quedaron los tiempos de los comentarios en el propio blog. La ley de protección de datos y el spam pudieron con ellos. Ahora puedes plantearme cualquier duda, comentario o sugerencia en <a href=https://twitter.com/sherblogpro>@sherlockes</a> en Twitter o Telegram.</div></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2022 Sherlockes.
<span class=footer__copyright-credits>Generado con <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> y <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a>.</span></br>Esta obra está bajo una <a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/>licencia de Creative Commons Reconocimiento-CompartirIgual 4.0 Internacional</a>.</br></br><a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/><img alt="Licencia de Creative Commons" style=border-width:0 src=https://i.creativecommons.org/l/by-sa/4.0/88x31.png></a></div></div></footer></div><script async defer src=/js/menu.js></script>
<script src=/js/custom.js></script></body></html>