<!doctype html><html class=no-js lang=es><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Archivos de Telegram al NAS - Sherblog</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content="El método que empleo para descargar archivos de Telegram al NAS desde Android sin gastar datos."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://www.sherblog.pro/images/20191207_telegram_nas.jpg"><meta name=twitter:title content="Archivos de Telegram al NAS"><meta name=twitter:description content="El método que empleo para descargar archivos de Telegram al NAS desde Android sin gastar datos."><meta name=twitter:creator content="@sherblogpro"><meta name=twitter:site content="sherblog.pro"><meta property="og:type" content="article"><meta property="og:locale" content="es_ES"><meta property="og:site_name" content="sherblog.pro"><meta property="og:locale" content="es_ES"><meta property="og:title" content="Archivos de Telegram al NAS"><meta property="og:url" content="https://sherlockes.github.io"><meta property="og:description" content="El método que empleo para descargar archivos de Telegram al NAS desde Android sin gastar datos."><meta property="og:image" content="http://www.sherblog.pro/images/20191207_telegram_nas.jpg"><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/custom.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><meta name=twitter:card content="summary"><meta name=twitter:title content="Archivos de Telegram al NAS"><meta name=twitter:description content="El método que empleo para descargar archivos de Telegram al NAS desde Android sin gastar datos."><div class=container><div class=logo><a class=logo__link href=/ title=Sherblog rel=home><div class=logo__title>Sherblog</div><div class=logo__tagline>Sólo mi forma de hacer las cosas...</div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menú</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/mis-v%C3%A9rtices-geod%C3%A9sicos/><span class=menu__text>Mis vértices geodésicos</span></a></li><li class=menu__item><a class=menu__link href=/post/computing/raspberry/><span class=menu__text>Raspberry Pi desde cero</span></a></li><li class=menu__item><a class=menu__link href=/post/android/tasker/><span class=menu__text>Tasker</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Archivos de Telegram al NAS</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2020-01-02T00:00:00Z>2020-01-02</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/sherver/ rel=category>sherver</a></span></div></div></header><figure class="post__thumbnail thumbnail"><img class=thumbnail__image src=/images/20191207_telegram_nas.jpg alt="Archivos de Telegram al NAS"></figure><div class="post__toc toc"><div class=toc__title>Índice</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#de-telegram-a-google-drive-via-bot>De Telegram a Google Drive (Via Bot)</a><ul><li><a href=#getpubliclinkbothttpstmehk_driveupload_bot><a href=https://t.me/HK_Driveupload_Bot>@GetPublicLinkBot</a></a></li><li><a href=#google-drive-uploader-20httpstmedriveuploadbot><a href=https://t.me/driveuploadbot>Google Drive Uploader 2.0</a></a></li><li><a href=#google-drive-bothttpstmegdriveit_bot><a href=https://t.me/@Gdriveit_bot>Google Drive Bot</a></a></li></ul></li><li><a href=#acondicionando-google-drive>Acondicionando Google Drive</a></li><li><a href=#de-google-drive-al-nas>De Google Drive al NAS</a></li><li><a href=#que-queda-por-hacer->Que queda por hacer ?</a></li></ul></nav></div></div><div class="content post__content clearfix"><p>Hace mucho tiempo que llevo buscando un método para descargar archivos desde Telegram (en mi teléfono Android) al NAS sin estar en la misma red local ni usar datos de mi tarifa móvil. Ahora creo que he dado con una forma rápida y sencilla&mldr;</p><p>A día de hoy, todavía no he dado con la forma de hacerlo de un solo paso por lo que voy a dividir las tareas en dos.</p><ul><li>Enviar los archivos de Telegram a Google Drive</li><li>Descargar los archivos de Google Drive al NAS</li></ul><h2 id=de-telegram-a-google-drive-via-bot>De Telegram a Google Drive (Via Bot)</h2><p>Para enviar los archivos desde Telegram hasta Google Drive, aunque existen alternativas de pago, utilizo varias alternativas gratuitas en forma de bots. Como no voy a dar acceso a mi cuenta personal de Google a estos bots de terceros, estoy una cuenta secundaria solo para estos menesteres.</p><h3 id=getpubliclinkbothttpstmehk_driveupload_bot><a href=https://t.me/HK_Driveupload_Bot>@GetPublicLinkBot</a></h3><blockquote><p>20191226 - El Bot no va fino, hay que reintentar muchas veces hasta que consigues que te genera el enlace.</p></blockquote><p>Este conocido bot de Telegram es capaz de generar un link de descarga público para archivos que están dentro de Telegram para lo que simplemente hay que compartir con el el archivo que deseas descargar y posteriormente generar un &ldquo;Resumable Link&rdquo;.</p><p><img src=/images/20191207_telegram_nas_01.jpg alt=imagen_01></p><p>Tras esperar un rato el bot nos responderá con un mensaje en el que se incluirá un link de descarga directa que podremos pasar a la utilidad de descarga del NAS (En mi caso y para Synology se trata de DS Get).</p><blockquote><p>Puede parecer que descargar directamente este archivo con la utilidad de Synology es el método más rápido pero nada más lejos de la realidad ya que el paso intermedio por Google Drive nos evita una operación manual y tener el NAS encendido las 24 horas del día.</p></blockquote><p>En la misma respuesta y si previamente hemos dotado al Bot de privilegios de acceso a nuestra cuenta de Google Drive, también dispondremos de un enlace que nos guardará el archivo en nuestra cuenta de la nube pública de Google.</p><h3 id=google-drive-uploader-20httpstmedriveuploadbot><a href=https://t.me/driveuploadbot>Google Drive Uploader 2.0</a></h3><p>Ahora (20191225) parece que funciona, tan sencillo como unirse a un canal de difusión del autor, autorizar el acceso a la cuenta de Google Drive al Bot y pegar en el mismo el código de acceso. Si aguanta habrá que hacer una donación&mldr;</p><ul><li>Con el comando <code>/auth</code> nos da acceso al link de autentificación</li><li>Damos permiso desde nuestra cuenta de Google</li><li>Copiamos el código de acceso que nos muestra el navegador</li><li>Pegamos el código en el bot y se lo enviamos</li></ul><h3 id=google-drive-bothttpstmegdriveit_bot><a href=https://t.me/@Gdriveit_bot>Google Drive Bot</a></h3><p>Ahora (20191225) parece que funciona. Es un Bot con el que puedes descargar 1.5Gb al día, para descargar más hay que pagar, de momento lo estoy usando como método de emergencia.</p><blockquote><p>Este Bot tiene la peculiaridad de que ademas de reenviarle el archivo que deseas descargar hay que responderle desde dentro del mismo con el comando &ldquo;Upload&rdquo;</p></blockquote><h2 id=acondicionando-google-drive>Acondicionando Google Drive</h2><p>Cada Bot deja el archivo en una carpeta distinta de la cuenta de google Drive (Lo cual no es posible de cambiar en la configuración del Bot), una vez allí utilizo un pequeño programa de <a href=https://script.google.com>Google Scripts</a> para moverlos a la carpeta que posteriormente voy a sincronizar desde el NAS. Este script realiza los siguientes pasos:</p><ul><li>Selecciona la carpeta compartida</li><li>Crea una matriz con las posible ubicaciones de los Bot</li><li>Mueve todos los archivos de las distintas carpetas a la carpeta compartida</li><li>Si ya llevan más de 24 horas allí, elimina los archivos de la carpeta compartida</li><li>Vacía la papelera de Google Drive</li></ul><pre tabindex=0><code>function move_files() {
  // Carpeta compartida Shd_Sherlockes78
  var shd_id = &#34;1RoVpSOD0wzGZ-1OPweS9DR55wwndKcbO&#34;
  var shd_folder = DriveApp.getFolderById(shd_id)
  
  // Carpetas donde buscar los archivos para mover  
  var folders_id = [];
  // Carpeta compartida &#34;driveuploadbot&#34;
  folders_id.push(&#34;1Lf190bC0KFjWcLywjvCXuNehBSRlGFfS&#34;);
  // Carpeta compartida &#34;driveuploadbot&#34;
  folders_id.push(&#34;1qxy6waDIaCl6r8UdkiEm6XZ_DLKFedGF&#34;);
  
  for each (var folder_id in folders_id)
  {
    var to_move_folder = DriveApp.getFolderById(folder_id)
    var to_move_files = to_move_folder.getFiles();
    while (to_move_files.hasNext()) {
      var file = to_move_files.next();
      shd_folder.addFile(file);
      to_move_folder.removeFile(file);
    }
  }
  
  // Mueve los archivos de la carpeta a la papelera cuando han pasado 24 horas
  var shd_files = shd_folder.getFiles();
  while (shd_files.hasNext()) {
    var file = shd_files.next();
    if (new Date() - file.getLastUpdated() &gt; 24 * 60 * 60 * 1000) {
      file.setTrashed(true);
    }
  }
  
  // Vacía la papelera
  Drive.Files.emptyTrash();
}
</code></pre><p>Para que sea posible la eliminación de los archivos de la papelera de reciclaje de la cuenta de Google Drive, previamente hay que seguir los pasos expuestos en el tutorial de Amixa de como <a href=https://www.amixa.com/blog/2019/04/05/automatically-empty-google-drive-trash/>Vaciar la papelera</a> mediante el API de Google Drive.</p><h2 id=de-google-drive-al-nas>De Google Drive al NAS</h2><p>Esta parte es fácil gracias a la utilidad de Synology &ldquo;Cloud Sync&rdquo; que nos descargará los archivos de una carpeta específica de la nube al NAS.</p><p><img src=/images/20191207_telegram_nas_02.jpg alt=imagen_02></p><p>Configuramos la tarea para que sólo descargue los cambios en la nube en lugar de hacerlo de forma manual y listo.</p><h2 id=que-queda-por-hacer->Que queda por hacer ?</h2><p>Pues si, llegados a este punto todavía quedan algunas cosas por hacer con los archivos descargados.</p><ul><li>Descomprimirlos si están conformados por varias partes.</li><li>Renombrarlos de una forma homogénea.</li><li>Moverlos a la ubicación adecuada.</li></ul><p>Estos tres pasos los realizo de forma manual, casi siempre desde Android con la aplicación de Synology &ldquo;DS File&rdquo;.</p></div><footer class=post__footer><div class="content post__content clearfix"><h3>Otros de mís artículos que te pueden interesar</h3><ul><li><a href=/encender-el-nas-desde-el-tel%C3%A9fono/>Encender el Nas desde el teléfono</a></li><li><a href=/insertar-en-twitter-enlaces-a-hugo-con-imagen/>Insertar en Twitter enlaces a Hugo con imagen</a></li><li><a href=/rclone-en-synology/>Rclone en Synology</a></li><li><a href=/la-joya-de-la-corona/>La joya de la corona</a></li></ul></div><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/telegram/ rel=tag>telegram</a></li><li class=tags__item><a class="tags__link btn" href=/tags/google-drive/ rel=tag>Google Drive</a></li><li class=tags__item><a class="tags__link btn" href=/tags/google-scripts/ rel=tag>Google Scripts</a></li></ul></div></footer></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/subtotales-en-google-sheets/ rel=prev><span class=pager__subtitle>«&#8201;Anterior</span><p class=pager__title>Subtotales en Google Sheets</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=/a%C3%B1adir-una-red-social-a-hugo-con-el-tema-mainroad/ rel=next><span class=pager__subtitle>Siguiente&#8201;»</span><p class=pager__title>Añadir una red social a Hugo con el tema Mainroad</p></a></div></nav><div class="content post__content clearfix"><h3>Comentarios</h3>Atrás quedaron los tiempos de los comentarios en el propio blog. La ley de protección de datos y el spam pudieron con ellos. Ahora puedes plantearme cualquier duda, comentario o sugerencia en <a href=https://emacs.ch/@sherlockes>@sherlockes</a> en Mastodon o Telegram.</div></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2023 Sherlockes.
<span class=footer__copyright-credits>Generado con <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> y <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a>.</span></br>Esta obra está bajo una <a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/>licencia de Creative Commons Reconocimiento-CompartirIgual 4.0 Internacional</a>.</br></br><a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/><img alt="Licencia de Creative Commons" style=border-width:0 src=https://i.creativecommons.org/l/by-sa/4.0/88x31.png></a></div></div></footer></div><script async defer src=/js/menu.js></script>
<script src=/js/custom.js></script></body></html>